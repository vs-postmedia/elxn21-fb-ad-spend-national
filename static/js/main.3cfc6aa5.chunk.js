(this["webpackJsonpelxn2021-fb-ad-spend"]=this["webpackJsonpelxn2021-fb-ad-spend"]||[]).push([[0],{156:function(t,a,e){},158:function(t,a,e){},160:function(t,a,e){},161:function(t,a,e){},162:function(t,a,e){},163:function(t,a,e){},164:function(t,a,e){},165:function(t,a,e){},166:function(t,a,e){"use strict";e.r(a);var n=e(4),r=e(55),c=e.n(r),o=e(19),s=e(20),i=e(21),u=e(25),l=e(56),d=e.n(l),p=["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],f={numberWithCommas:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},map:function(t,a,e,n,r){return(t-a)*(r-n)/(e-a)+n},getPostmediaMonth:function(t){return p[t]}},h=(e(156),e(0)),m=function(t){return Object(h.jsxs)("div",{className:"stat",children:[Object(h.jsx)("p",{className:"big-num ".concat(t.data.party.toLowerCase()),children:"$".concat(f.numberWithCommas(t.data.total))}),Object(h.jsx)("p",{className:"label",children:t.data.party})]})},b=(e(158),function(t){var a=t.data,e=t.lastUpdate.split("-"),n=f.getPostmediaMonth(parseInt(e[1])-1),r=e[2];return Object(h.jsxs)("div",{className:"summary-box",children:[Object(h.jsx)("div",{className:"stat-box",children:a.map((function(t,a){return Object(h.jsx)(m,{data:t},a)}))}),Object(h.jsx)("p",{className:"last-update",children:"From Aug. 15 to ".concat(n," ").concat(r)})]})}),j=e(5),y=e.n(j),g=e(14),v=e(57),x=e(6),O=e(59),k=e(11),w=(e(160),k.a("%B %d"));var _,N,F,A,C=function(t){var a=t.target.__data__.total,e=t.target.__data__.date;return'\n\t\t<div class="tooltip-content">\n\t\t\t<p class="date">'.concat(w(e),'</p>\n\t\t\t<p class="total-amount">$').concat(f.numberWithCommas(a),"</p>\n\t\t</div>\n\t")},W=(e(161),Object(O.a)()),D=15,M=15,S=40,B=25;function E(){return(E=Object(v.a)(y.a.mark((function t(a){var e,n,r,c,o;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _=150,e=2,t.next=4,I(a);case 4:n=t.sent,r=x.f("#charts"),c=r.node().getBoundingClientRect(),window.innerWidth>400&&(e=3),N=c.width/e-B-M,(o=r.selectAll("svg").data(n).enter().append("svg").attr("class",(function(t){return t.party.toLowerCase()})).style("height","".concat(_,"px")).style("width","".concat(N+B+M,"px")).append("g").attr("transform","translate(".concat(B,", ").concat(D,")"))).append("text").text((function(t){return t.party})).attr("class",(function(t){return"".concat(t.party.toLowerCase()," label-text")})),F=Y(n[0].values),A=P(n[0].values),o.append("g").call(L),o.append("g").call($),o.append("g").selectAll("rect").data((function(t){return t.values})).enter().append("rect").attr("x",(function(t){return F(t.date)})).attr("y",(function(t){return A(t.total)})).attr("height",(function(t){return A(0)-A(t.total)})).attr("width",F.bandwidth()).on("mouseover touchstart",U).on("mouseout touchend",J);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var J=function(){W.hide()},U=function(t){var a=t.touches?t.touches[0].clientX:t.clientX,e=t.touches?t.touches[0].clientY:t.clientY;W.point(a,e),W.html(C(t)),W.draw()},I=function(t){var a=t.data,e=t.order;return a.forEach((function(t){t.values.forEach((function(t){t.date=x.h("%Y-%m-%d")(t.date)}))})),[].concat(Object(g.a)(a.filter((function(t){return t.party===e[0]}))),Object(g.a)(a.filter((function(t){return t.party===e[1]}))),Object(g.a)(a.filter((function(t){return t.party===e[2]}))),Object(g.a)(a.filter((function(t){return t.party===e[3]}))),Object(g.a)(a.filter((function(t){return t.party===e[4]}))))},L=function(t){var a=F.domain();t.attr("transform","translate(0, ".concat(_-S,")")).attr("class","x-axis axis").call(x.a(F).tickSize(0).tickFormat(x.g("%b. %d")).tickPadding([10]).tickValues([a[0],a[a.length-1]]))},$=function(t){t.attr("class","y-axis axis").call(x.b(A).ticks(2).tickSize(-N).tickFormat((function(t){return"".concat(f.numberWithCommas(t/1e3))}))).call((function(t){return t.select(".domain").remove()}))},P=function(t){return x.e().domain([0,x.c(t,(function(t){return parseInt(t.total)}))]).nice().range([_-S,D])},Y=function(t){return x.d().rangeRound([0,N],.5).padding(.1).domain(t.map((function(t){return t.date})))},z=function(t){return E.apply(this,arguments)},R=(e(162),function(t){return Object(n.useEffect)((function(){z(t)})),Object(h.jsxs)("div",{className:"daily-charts",children:[Object(h.jsxs)("h2",{children:["Daily Facebook ad spend ",Object(h.jsx)("span",{className:"h2-small",children:"($000\u2019s)"})]}),Object(h.jsx)("div",{id:"charts"})]})}),X=(e(163),e(58)),T=e(54),V=function(t){Object(i.a)(e,t);var a=Object(u.a)(e);function e(){var t;Object(o.a)(this,e);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(t=a.call.apply(a,[this].concat(r))).state={party_data:[],party_daily:[]},t}return Object(s.a)(e,[{key:"componentDidMount",value:function(){var t=this;d.a.get(this.props.dataUrl).then((function(a){t.setState({last_update:a.data.lastUpdate,party_data:a.data.party_total,party_daily:q(a.data.party_daily),party_order:a.data.party_total.map((function(t){return t.party}))})}))}},{key:"render",value:function(){return this.state.party_data.length>0?Object(h.jsxs)(n.Fragment,{children:[Object(h.jsx)(b,{className:"summary-box",data:this.state.party_data,lastUpdate:this.state.last_update}),Object(h.jsx)(R,{data:this.state.party_daily,order:this.state.party_order})]}):Object(h.jsx)(n.Fragment,{})}}]),e}(n.Component);function q(t){return t?X.a().key((function(t){return t.party})).key((function(t){return t.date})).rollup((function(t){return{total:T.a(t,(function(t){return t.total_spend}))}})).entries(t).map((function(t){return{party:t.key,values:t.values.map((function(t){return{date:t.key,timestamp:new Date(t.key).getTime(),total:t.value.total}})).sort((function(t,a){return t.timestamp-a.timestamp}))}})):null}e(164);var G=function(){return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)("h2",{children:"Election ad spending on Facebook and its platforms..."}),Object(h.jsx)(V,{dataUrl:"https://vs-postmedia-data.sfo2.digitaloceanspaces.com/elxn/elxn21/fb-ad-spend.json"}),Object(h.jsx)("footer",{children:Object(h.jsxs)("p",{className:"source",children:["Source: ",Object(h.jsx)("a",{href:"https://www.facebook.com/ads/library/",target:"_blank",rel:"noopener noreferrer",children:"Facebook Ad Library"})," \u2022 Data includes spending by the official Facebook pages for each party and party leaders.  Data includes ads placed on Facebook, Instagram, WhatsApp, Messenger and Oculus."]})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));e(165),e.p,e.p,e.p,e.p,e.p,e.p;c.a.render(Object(h.jsx)(G,{}),document.getElementById("app")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[166,1,2]]]);
//# sourceMappingURL=main.3cfc6aa5.chunk.js.map